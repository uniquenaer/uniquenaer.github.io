(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{228:function(t,e,s){"use strict";s.r(e);var n=s(0),i=Object(n.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),s("p",[t._v("最近几年 Restful API 及 SPA(单页面应用) 的盛行，cookie-session 的机制似乎越来越不适合前后端分离的场景。\n在分布式和微服务的趋势下，不少人选择在 redis 中存储 session 来达到单点登陆的效果，这无疑增加了成本和开发难度。\n于是更多的人转而使用 jwt 来管理用户会话和授权，在 jwt"),s("a",{attrs:{href:"https://jwt.io/introduction/",target:"_blank",rel:"noopener noreferrer"}},[t._v("官网"),s("OutboundLink")],1),t._v("介绍其两大使用场景。")]),t._v(" "),t._m(2),t._v(" "),s("p",[t._v("关于 jwt 的使用及生态请阅读 jwt"),s("a",{attrs:{href:"https://jwt.io/introduction/",target:"_blank",rel:"noopener noreferrer"}},[t._v("官网"),s("OutboundLink")],1),t._v("获得更多信息。")]),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._m(14),t._v(" "),t._m(15),s("p",[t._v("服务器会解析该字段并得到用户信息，对用户进行鉴权。")]),t._v(" "),t._m(16),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._m(21),t._v(" "),t._m(22),s("p",[t._v("服务器会解析该字段，如 refresh_token 字段未过期则会发送新的 access_token。")])])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"jwt-使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#jwt-使用","aria-hidden":"true"}},[this._v("#")]),this._v(" jwt 使用")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"为何选择-jwt"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#为何选择-jwt","aria-hidden":"true"}},[this._v("#")]),this._v(" 为何选择 jwt?")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[e("p",[this._v("Authorization(授权)：这是 jwt 应用最为广泛的场景。jwt 将数据加密存储，分发给前端，前端将其放在特定的 header 字段 中（也有放在 params 和 body 中），服务器收到请求后，解析 jwt 判断用户身份，对用户请求进行限权。")])]),this._v(" "),e("li",[e("p",[this._v("Information Exchange(数据交换): jwt 可以通过公钥和私钥对信息进行加密，双方通信后，互得数据。")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"access-token-和-refresh-token"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#access-token-和-refresh-token","aria-hidden":"true"}},[this._v("#")]),this._v(" access_token 和 refresh_token")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("在一般 jwt 应用中，"),e("em",[this._v("access_token")]),this._v("和"),e("em",[this._v("refresh_token")]),this._v("是一对相互帮助的好搭档，前面讲到用户在前端登陆后，服务器会发送 access_token 和 refresh_token\n给前端，前端在得到这两个 token 之后必须"),e("strong",[this._v("谨慎存储")]),this._v("。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[e("p",[this._v("access_token ：用来用户鉴权，控制用户对接口，资源的访问。access_token 十分重要，它是服务器对前端有力控制的唯一途径，故一般其生存周期十分短，一般在 2 个小时左右，更有甚者，其生命周期只有 15 分钟。")])]),this._v(" "),e("li",[e("p",[this._v("refresh_token ：用户通过登陆后获得 access_token，而 access_token 的生命周期十分短暂，但是用户登陆太频繁会严重影响体验，因此需要一种免登陆便能获取\naccess_token 的方式。refresh_token 主要用来解决该问题，refresh_token 的生命周期较长，一般为 30 天左右，但 refresh_token 不能被用来用户身份鉴权和获取资源，它只能被用来重新获取 access_token。当前端发现 access_token 过期时，便应通过 refresh_token 重新获取 access_token。")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"项目中的使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#项目中的使用","aria-hidden":"true"}},[this._v("#")]),this._v(" 项目中的使用")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"用户获取-access-token-和-refresh-token"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#用户获取-access-token-和-refresh-token","aria-hidden":"true"}},[this._v("#")]),this._v(" 用户获取 access_token 和 refresh_token")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("path")]),this._v(": /user/login")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("method")]),this._v(": post")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("参数")]),this._v(":")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("table",[s("thead",[s("tr",[s("th",[t._v("name")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("说明")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("类型")]),t._v(" "),s("th",[t._v("作用")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("nickname")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("用户名")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),s("td",[t._v("****")])]),t._v(" "),s("tr",[s("td",[t._v("password")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("密码")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),s("td",[t._v("****")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("结果")]),this._v(":")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{attrs:{class:"token property"}},[t._v('"access_token"')]),s("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE1MzU1MzMyNjMsIm5iZiI6MTUzNTUzMzI2MywianRpIjoiMTlkZWUwNzQtNzUxYi00MjBlLTk3NjAtZDRkMzc3YjdjMjUyIiwiZXhwIjoxNTM1NjE5NjYzLCJpZGVudGl0eSI6InBlZHJvIiwiZnJlc2giOmZhbHNlLCJ0eXBlIjoiYWNjZXNzIn0.9sNmAV5anxY5N1S1kaXzRRpdjzVX3fX6iI0ZjxGiiVs"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{attrs:{class:"token property"}},[t._v('"refresh_token"')]),s("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE1MzU1MzMyNjMsIm5iZiI6MTUzNTUzMzI2MywianRpIjoiYjU0OWIwZGEtMTE3MS00NzJlLWE0MDMtMDFkMGRkZTRjOTYzIiwiZXhwIjoxNTM4MTI1MjYzLCJpZGVudGl0eSI6InBlZHJvIiwidHlwZSI6InJlZnJlc2gifQ.cBnqEBnome-dMFEueQ8oCJfoXX9_mzQJAGjyeq4bYh8"')]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[s("code",[t._v("使用")]),t._v(":\n在请求其他资源或接口时在 header 中，加入"),s("code",[t._v("Authorization")]),t._v("字段，字段值为"),s("code",[t._v("Bearer")]),t._v("加上"),s("code",[t._v("access_token")]),t._v("，注意两个字段中间必须有一个空格，如下：")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[this._v("Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE1MzU1MzMyNjMsIm5iZiI6MTUzNTUzMzI2MywianRpIjoiMTlkZWUwNzQtNzUxYi00MjBlLTk3NjAtZDRkMzc3YjdjMjUyIiwiZXhwIjoxNTM1NjE5NjYzLCJpZGVudGl0eSI6InBlZHJvIiwiZnJlc2giOmZhbHNlLCJ0eXBlIjoiYWNjZXNzIn0.9sNmAV5anxY5N1S1kaXzRRpdjzVX3fX6iI0ZjxGiiVs\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"refresh-token-获取-access-token"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#refresh-token-获取-access-token","aria-hidden":"true"}},[this._v("#")]),this._v(" refresh_token 获取 access_token")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("path")]),this._v(": /user/refresh")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("method")]),this._v(": get")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("code",[this._v("参数")]),this._v(": 无，注意在 Authorization 中加上 refresh_token。\n"),e("code",[this._v("结果")]),this._v(":")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{attrs:{class:"token punctuation"}},[this._v("{")]),this._v("\n  "),e("span",{attrs:{class:"token property"}},[this._v('"access_token"')]),e("span",{attrs:{class:"token operator"}},[this._v(":")]),this._v("\n    "),e("span",{attrs:{class:"token string"}},[this._v('"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE1MzU1MzMyNjMsIm5iZiI6MTUzNTUzMzI2MywianRpIjoiMTlkZWUwNzQtNzUxYi00MjBlLTk3NjAtZDRkMzc3YjdjMjUyIiwiZXhwIjoxNTM1NjE5NjYzLCJpZGVudGl0eSI6InBlZHJvIiwiZnJlc2giOmZhbHNlLCJ0eXBlIjoiYWNjZXNzIn0.9sNmAV5anxY5N1S1kaXzRRpdjzVX3fX6iI0ZjxGiiVs"')]),this._v("\n")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[s("code",[t._v("使用")]),t._v("：\n用户获取资源时，"),s("code",[t._v("Authorization")]),t._v("字段的值为"),s("code",[t._v("Bearer")]),t._v("加上"),s("code",[t._v("access_token")]),t._v("，当通过 refresh_token 获取 access_token 时，应将"),s("code",[t._v("Authorization")]),t._v("中的 access_token 替换为 refresh_token，如：")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[this._v("Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE1MzU1MzMyNjMsIm5iZiI6MTUzNTUzMzI2MywianRpIjoiYjU0OWIwZGEtMTE3MS00NzJlLWE0MDMtMDFkMGRkZTRjOTYzIiwiZXhwIjoxNTM4MTI1MjYzLCJpZGVudGl0eSI6InBlZHJvIiwidHlwZSI6InJlZnJlc2gifQ.cBnqEBnome-dMFEueQ8oCJfoXX9_mzQJAGjyeq4bYh8\n")])])])}],!1,null,null,null);e.default=i.exports}}]);